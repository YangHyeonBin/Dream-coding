# 마진 병합 현상

## 어떤 현상인가

- 블록 요소들은 상하 margin을 적용할 수 있음
- 여러 형제 블록 요소들에게 margin을 줄 때, 위에 있는 요소의 margin-bottom과 아래에 있는 요소의 margin-top 영역이 겹침
- 이럴 때 자동으로 마진을 병합해 두 요소 사이의 margin(간격)이 두 배로 적용되는 것을 막아주는 것이 마진 병합 현상
- 서로 인접한 margin 중 더 **큰** 영역을 차지하는 것으로 margin이 병합되는 것 (2개의 margin -> **하나**로 병합)

```css
div {
  margin: 20px;
}

p {
  margin: 20px;
}
```

- 위의 `div`와 `p`가 형제 요소일 경우, 두 요소 사이의 (상하) 간격이 40px이 아니라 20px이도록 해주는 것!

## 발생 조건

1. 서로 **인접한** **block** 요소

   "인접한"?

   - 형제 관계
   - 부모-자식 관계인데,

     1. 부모 요소에 인라인 컨텐츠가 없거나
     2. 부모 요소에 border가 없거나
     3. 부모 요소에 padding이 없으면서

     _블록 서식 맥락(block format context)을 생성하지 않은 경우_

2. 상하 방향으로만 발생 (좌우 margin은 병합되지 않음 -> 블록 요소이니 당연)

## 문제 발생

- **부모 요소(=인접한 요소)**에 아무런 내용물 없이 자식 요소(display 값이 block인)가 있을 수 있음
- 자식 요소에 margin을 주려고 할 수 있음
- 그럴 때, 부모 요소의 컨텐츠 박스 안에 margin(여백)이 들어갈 것으로 예상할 수 있음
- 스타일링을 용이하게 하기 위해 전체 선택자(`*`)를 이용해 모든 요소에 `margin: 0`을 줬을 경우, 부모 요소의 `margin: 0`과 자식 요소에 적용한 margin이 **병합**되어 부모 요소의 컨텐츠 박스 **밖에** margin이 적용됨
- 자식 요소의 margin을 부모 요소 내부에 주고 싶다면?

## 해결방법

### 1. 마진 병합 현상의 발생을 막는 방법

1. 부모 요소 컨텐츠 박스에 내용물을 추가 (어떤 글자라도 넣는다.)
2. 부모 요소에 padding을 추가
3. 부모 요소에 border를 추가 (`border: 1px solid transparent;`)

-> 구현하고자 하는 디자인 시안이 있을 경우, 이런 식으로 마음대로 바꿔선 안 됨

### 2. 마진 병합 현상 발생의 조건을 이용하는 방법

- display 값이 block일 때만 발생하므로, inline-block으로 변경

-> 자식 요소들 간의 마진 병합 현상까지 상쇄되어, 추가 작업을 해줘야 함

### 3. 가장 괜찮은 해결법

- 부모 요소에 `overflow: hidden;` 추가

-> 부모 요소와 자식 요소의 margin을 별개의 영역으로 만들어 줌

(보충 설명)

- overflow 값이 visible(기본값)이 아닌 경우, 새로운 블록 서식 문맥/맥락(block format context)을 생성함
- 블록 서식 맥락: block 박스의 레이아웃이 발생하는 지점
- 이때의 블록 **!=** display 값 중 하나인 block
- 부모 요소에서 새로운 블록 서식 맥락을 생성하면, 자신의 자식 요소들을 모두 감쌀 수 있게 되어, float된 자식이나 position 값이 absolute, fixed로 지정되어 **부모의 맥락(-> 이것이 여기서의 block 개념이 아닐까?)에서 벗어난 자식** 등을 모두 감쌀 수 있게 됨

- 부모의 맥락, 부모의 block 영역에서 벗어난 자식은, 자기만의 block 서식 맥락을 따로 생성했기에 벗어난 것 같다. mdn의 블록 서식 맥락 문서를 보면 어떤 조건에서 블록 서식 맥락을 생성하는지 확인할 수 있는데, float에 none이 아닌 값을 준 경우, position에 absolute, fixed 값을 준 경우, display 값이 inline-block인 경우, overflow 값이 visible(기본 값)이 아닌 경우 등이 있다.
- 위에서 설명한 마진 병합 현상에 의해 발생한 문제를 해결하기 위해 거꾸로, 의도적으로 부모 요소가 새로운 블록 서식 맥락을 생성하도록 하는 것.
- (참고) overflow에 auto 값을 주면, 기본 값인 visible과 유사해 보이나, 새로운 블록 서식 맥락을 생성했기에, 부모보다 자식 요소의 크기가 크다면 스크롤을 만듦
- (참고) overflow에 hidden 값을 주면, 새로운 블록 서식 맥락 생성, 부모보다 자식 요소의 크기가 클 때, 자식 요소 컨텐츠를 잘라냄
